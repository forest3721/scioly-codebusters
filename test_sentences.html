<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cipher Sentence Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .test-case { background: white; margin: 15px 0; padding: 15px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .original { font-weight: bold; color: #2c3e50; }
        .encoded { font-family: monospace; color: #e74c3c; }
    </style>
</head>
<body>
    <h1>Cipher Sentence Encoding Test</h1>
    <div id="test-results"></div>
    
    <script src="static/js/script.js"></script>
    <script>
        // Test sentences
        const testSentences = [
            'The quick brown fox.',
            'Science Olympiad rocks!',
            'Practice makes perfect.',
            'Hello World!'
        ];
        
        // All cipher types to test
        const cipherTypes = ['caesar', 'atbash', 'keyword', 'vigenere', 'morse', 'binary', 'aristocrats', 'affine', 'baconian', 'polybius'];
        
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🧪 Starting cipher sentence tests...');
            
            // Create a temporary app instance for testing
            const testApp = new CodeBreakerApp();
            const resultsDiv = document.getElementById('test-results');
            
            let allResults = [];
            
            cipherTypes.forEach(cipherType => {
                const cipherResults = [];
                console.log(`\n📝 Testing ${cipherType.toUpperCase()} cipher:`);
                
                testSentences.forEach(sentence => {
                    try {
                        // Set cipher type
                        testApp.currentCipher = cipherType;
                        
                        // Encode the sentence
                        const encoded = testApp.encodeText(sentence);
                        
                        let success = true;
                        let notes = '';
                        
                        // Basic validation: encoded text should be different from original (except for some special cases)
                        if (encoded === sentence && !['morse', 'binary', 'baconian', 'polybius'].includes(cipherType)) {
                            success = false;
                            notes = 'Encoding appears to have failed - output same as input';
                        }
                        
                        // Check that encoding actually happened
                        if (encoded.length === 0) {
                            success = false;
                            notes = 'Encoding produced empty output';
                        }
                        
                        console.log(`  "${sentence}" -> "${encoded}" ${success ? '✅' : '❌'} ${notes}`);
                        
                        cipherResults.push({
                            sentence,
                            encoded,
                            success,
                            notes
                        });
                        
                    } catch (error) {
                        console.error(`  "${sentence}" -> ERROR: ${error.message} ❌`);
                        cipherResults.push({
                            sentence,
                            encoded: 'ERROR',
                            success: false,
                            notes: error.message
                        });
                    }
                });
                
                allResults.push({
                    cipher: cipherType,
                    results: cipherResults
                });
            });
            
            // Display results in HTML
            let html = '';
            let totalTests = 0;
            let passedTests = 0;
            
            allResults.forEach(cipherData => {
                const cipherPassed = cipherData.results.filter(r => r.success).length;
                const cipherTotal = cipherData.results.length;
                totalTests += cipherTotal;
                passedTests += cipherPassed;
                
                html += `<div class="test-case">`;
                html += `<h2>${cipherData.cipher.toUpperCase()} Cipher - ${cipherPassed}/${cipherTotal} passed</h2>`;
                
                cipherData.results.forEach(result => {
                    html += `<div class="test-result ${result.success ? 'success' : 'error'}">`;
                    html += `<div class="original">Original: "${result.sentence}"</div>`;
                    html += `<div class="encoded">Encoded: "${result.encoded}"</div>`;
                    if (result.notes) {
                        html += `<div>Notes: ${result.notes}</div>`;
                    }
                    html += `</div>`;
                });
                
                html += `</div>`;
            });
            
            // Summary
            html = `<div class="test-case"><h1>Summary: ${passedTests}/${totalTests} tests passed (${Math.round(passedTests/totalTests*100)}%)</h1></div>` + html;
            
            resultsDiv.innerHTML = html;
            console.log(`\n📊 Overall Results: ${passedTests}/${totalTests} tests passed (${Math.round(passedTests/totalTests*100)}%)`);
        });
    </script>
</body>
</html>